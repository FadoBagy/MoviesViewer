@model SearchQueryModel
@{
	ViewData["Title"] = "Search";
	string posterPath = "https://image.tmdb.org/t/p/w500";
	string ratingColor;
}

<div class="search-bar">
	<form method="get" autocomplete="off">
		<input asp-for="SearchTerm" class="form-control" />
	</form>
	<div class="filters">
		<div class="filter-item">
			<p>Action</p>
		</div>
		<div class="filter-item">
			<p>Comedy</p>
		</div>
		<div class="filter-item">
			<p>Horror</p>
		</div>
		<div class="filter-item">
			<p>Drama</p>
		</div>
		<div class="filter-item">
			<p>Thriller</p>
		</div>
		<div class="filter-item">
			<p>Adventure</p>
		</div>
		<div class="filter-item">
			<p>Sci-Fi</p>
		</div>
		<div class="filter-item">
			<p>Crime</p>
		</div>
		<div class="filter-item">
			<p>Documentary</p>
		</div>
		<div class="filter-item">
			<p>Fantasy</p>
		</div>
		<div class="filter-item">
			<p>History</p>
		</div>
		<div class="filter-item">
			<p>Romance</p>
		</div>
		<div class="filter-item">
			<p>War</p>
		</div>
		<div class="filter-item">
			<p>Western</p>
		</div>
		<div class="filter-item">
			<p>Popular</p>
		</div>
		<div class="filter-item">
			<p>Top rated</p>
		</div>
	</div>
</div>
<div class="result">
	@if (Model.SearchTerm != null && Model.Movies.Count() > 0)
	{
		<div class="row">
			@foreach (var movie in Model.Movies)
			{
				string rating = "0";

				if (movie.Rating != null)
				{
					rating = movie.Rating;
				}

				if (float.Parse(rating) >= 8)
				{
					ratingColor = "green";
				}
				else if (float.Parse(rating) >= 5)
				{
					ratingColor = "orange";
				}
				else if (float.Parse(rating) < 5 && float.Parse(rating) > 0)
				{
					ratingColor = "red";
				}
				else
				{
					ratingColor = "black";
				}

				<div class="card">
					<a asp-controller="Movie" asp-action="MovieTmdb" asp-route-id="@movie.TmdbId">
						@if (movie.PosterPath != null)
						{
							<img src="@(movie.TmdbId != null ? posterPath + movie.PosterPath : movie.PosterPath)" class="card-img-top" alt="@movie.Title poster">
						}
						else
						{
							<img src="~/images/default-icon.png" class="card-img-top">
						}
					</a>
					<div class="card-body">
						<div class="rating @ratingColor">
							<p>@(movie.Rating != null && float.Parse(movie.Rating) != 0 ? float.Parse(movie.Rating).ToString("0.0") : "NR")</p>
						</div>
						<h5 class="card-title">
							<a asp-controller="Movie" asp-action="MovieTmdb" asp-route-id="@movie.TmdbId">@movie.Title</a>
						</h5>
						<h6>@(movie.ReleaseDate != null ? movie.ReleaseDate.Value.ToString("MMM dd, yyyy") : "-")</h6>
					</div>
					<img class="info" src="~/images/information.png" alt="info button">
				</div>
			}
		</div>
	}
	else
	{
		<p id="no-results">No results</p>
	}
</div>
@*<div>
	<a asp-controller="Search"
		asp-action="Index" 
		asp-route-currentPage="@(Model.CurrentPage + 1)"
		asp-route-searchTerm="@Model.SearchTerm">More</a>
</div>*@

@section Styles {
	<link rel="stylesheet" href="~/css/search.css" />
	<link rel="stylesheet" href="~/css/movies.css" />
}